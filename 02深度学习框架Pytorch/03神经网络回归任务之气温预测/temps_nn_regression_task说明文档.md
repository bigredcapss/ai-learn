# 气温预测神经网络模型说明文档

## 项目概述

本项目使用PyTorch框架构建神经网络模型，对气温进行回归预测。通过历史气温数据及其他相关特征，训练一个深度学习模型来预测未来的最高气温。

## 数据集说明

项目使用的数据集为`data/temps.csv`，包含以下字段：

- **year, month, day**: 具体的日期信息
- **temp_2**: 前天的最高温度值
- **temp_1**: 昨天的最高温度值
- **average**: 历史中每年这一天的平均最高温度值
- **actual**: 当天的真实最高温度（标签值）
- **friend**: 朋友猜测的可能值（干扰特征，可忽略）

## 代码实现详解

### 1. 数据预处理

```python
features = pd.read_csv('data/temps.csv')
```

读取气温数据集，并进行初步的数据探索和可视化分析。

### 2. 特征工程

- 对分类变量进行独热编码（One-Hot Encoding）处理
- 使用`StandardScaler`对特征数据进行标准化处理
- 将数据转换为PyTorch张量格式

### 3. 模型构建

项目中实现了两种方式构建神经网络：

#### 手动实现版本
- 输入层：14个特征
- 隐藏层：128个神经元，使用ReLU激活函数
- 输出层：1个神经元，预测气温值

#### PyTorch Sequential版本
- 使用`torch.nn.Sequential`构建网络
- 隐藏层：128个神经元，使用Sigmoid激活函数
- 使用Adam优化器进行参数优化

### 4. 训练过程

- 使用均方误差（MSE）作为损失函数
- 采用小批量（Mini-Batch）梯度下降法进行训练
- 默认训练1000个epoch
- 每100个epoch输出一次损失值

### 5. 结果可视化

将真实气温值与模型预测值进行对比可视化展示，评估模型性能。

## 运行环境

- Python 3.x
- PyTorch
- pandas
- numpy
- matplotlib
- scikit-learn

## 使用方法

直接运行`temps_nn_regression_task.py`脚本即可：

```bash
python temps_nn_regression_task.py
```

程序将自动完成数据加载、模型训练和结果可视化过程。

## 关键知识点

1. **数据预处理**：包括独热编码、标准化等操作
2. **PyTorch基础**：张量操作、自动求导机制
3. **神经网络构建**：手动实现与Sequential方式
4. **优化算法**：梯度下降法与Adam优化器
5. **模型评估**：通过可视化对比真实值与预测值